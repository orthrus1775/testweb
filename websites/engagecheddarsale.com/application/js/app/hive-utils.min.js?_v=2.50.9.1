/*! the-hive */
"use strict";window.hiveUtils={makeRequest:function(r){return new Promise(function(e,t){var n=new XMLHttpRequest,o=(n.open(r.method,r.url),n.onload=function(){200<=this.status&&this.status<300?e(n.response):t({status:this.status,statusText:n.statusText})},n.onerror=function(){t({status:this.status,statusText:n.statusText})},r.headers&&Object.keys(r.headers).forEach(function(e){n.setRequestHeader(e,r.headers[e])}),r.params);o&&"object"==typeof o&&(o=Object.keys(o).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(o[e])}).join("&")),n.send(o)})},promiseTimeout:function(o,e){var t=new Promise(function(e,t){var n=setTimeout(function(){clearTimeout(n),t("Timed out in "+o+"ms.")},o)});return Promise.race([e,t])},waitForCondition:function(i,u,c,a){return u=u||50,c=c||500,a=a||!1,new Promise(function e(t,n){var o=!1===u||0<u--,r=i();r?t(r):o?setTimeout(function(){return e(t,n)},c):a?t(!1):n(Error("Condition not fulfilled in max retries"))})},getVideoThumbnail:function(o){var r=this;return new Promise(function(t,n){try{o=new URL(o)}catch(e){n(Error(e))}switch(!0){case-1!==o.hostname.indexOf("vim"):r.makeRequest({method:"GET",url:"https://vimeo.com/api/oembed.json?url="+o}).then(function(e){(e=JSON.parse(e))&&e.thumbnail_url?t(e.thumbnail_url):n(Error("Thumbnail not found."))}).catch(function(e){n(Error("Request failed: "+e.statusText))});break;case-1!==o.hostname.indexOf("youtu"):var e;null!==(e=/^.*(youtu\.be\/|vi?\/|u\/\w\/|embed\/|\?vi?=|\&vi?=)([^#\&\?]*).*/.exec(o.href))&&e[2]?t("https://img.youtube.com/vi/"+e[2]+"/hqdefault.jpg"):n(Error("Thumbnail not found."));break;default:t(null)}})},waitForElement:function(o,t){return new Promise(function(n,e){"string"!=typeof o&&t&&"string"!==t&&e(Error("selector must be a string")),(t=document.querySelector(t)||document.body).contains(document.querySelector(o))&&n(document.querySelector(o)),new MutationObserver(function(e,t){[].forEach.call(document.querySelectorAll(o),function(e){n(e),t.disconnect()})}).observe(t,{childList:!0,subtree:!0})})},waitForProperty:function(n,o,e){e=e||25e3;var t;return"object"==typeof o&&null!==o||reject(!1),o.hasOwnProperty(n)?(o["__"+n]&&this.queryablePromise(o["__"+n]).isFulfilled()&&delete o["__"+n],Promise.resolve(o[n])):o["__"+n]?Promise.resolve(o["__"+n]):(t=new Promise(function(t,e){Object.defineProperty(Object.prototype,n,{configurable:!0,set:function(e){Object.defineProperty(o,n,{value:e}),o["__"+n]&&delete o["__"+n],t(o[n])}})}),o["__"+n]=this.promiseTimeout(e,t),o["__"+n])},waitForNestedProperty:function(e,t,n){n=n||25e3;var o=this,e=e.split(".").reduce(function(e,t){return e.then(function(e){return o.waitForProperty(t,e,n)})},Promise.resolve(t));return this.promiseTimeout(n,e)},loadStylesheet:function(o){return new Promise(function(e,t){var n=document.createElement("link");n.onerror=t,n.onload=e,n.type="text/css",n.rel="stylesheet",document.head.appendChild(n),n.href=o})},loadScript:function(o,r){return new Promise(function(e,t){var n=document.createElement("script");n.async=r&&r.async||!0,n.defer=r&&r.defer||!1,n.onerror=t,n.onload=e,document.head.appendChild(n),n.src=o})},attributeObserver:function(o,r,e,i,t){if(o||!o!=document.documentElement&&!o!=document.body&&document.body.contains(o))return i=i||500,new Promise(function(n){new MutationObserver(e&&"function"==typeof e?e:function(e,t){e.forEach(function(e){r.includes(e.attributeName)&&(i&&0!=i&&t.disconnect(),r.forEach(function(e){n(o,o.getAttribute(e))}))})}).observe(o,{attributes:!0,attributeOldValue:t||!1,attributeFilter:["class","id"],characterData:!1,characterDataOldValue:!1,childList:!1,subtree:!1})})},createElement:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild},triggerEvent:function(e,t){var n;return"function"==typeof Event?n=new Event(t):(n=document.createEvent("Event")).initEvent(t,!0,!0),e.dispatchEvent(n),n},queryablePromise:function(e){var t,n,o;return"function"!=typeof e.then?console.error("Not a promise."):e.isResolved?e:(o=n=!(t=!0),(e=e.then(function(e){return t=!(o=!0),e},function(e){return t=!(n=!0),e})).isFulfilled=function(){return o},e.isPending=function(){return t},e.isRejected=function(){return n},e)},ajaxPoll:function(fn,params,conditions,timeout,interval,silent){var endTime=Number(new Date)+(timeout||2e3),checkCondition;return(interval=interval||100,silent=silent||!1,params&&!Array.isArray(params))?console.error("Params must be an array"):conditions&&!Array.isArray(conditions)?console.error("Conditions must be an array"):conditions.every(function(e){["==","!=","===","!==",">",">=","<","<="].includes(e[0])})?console.error("Invalid condition operator"):(checkCondition=function(resolve,reject){var ajax=fn.apply(void 0,params);ajax.then(function(response){var evaluateConditions=conditions.every(function(c){return eval("response.data['".concat(c[1],"'] == '").concat(c[2],"'"))});evaluateConditions?resolve(response.data):Number(new Date)<endTime?setTimeout(checkCondition,interval,resolve,reject):silent?resolve(!1):reject(Error("Timed out"))})},new Promise(checkCondition))},documentReady:function(e){if("function"==typeof e)return"interactive"===document.readyState||"complete"===document.readyState?e():void document.addEventListener("DOMContentLoaded",e,!1)},serialize:function(e){var n=[];return Array.prototype.slice.call(e.elements).forEach(function(t){!t.name||t.disabled||-1<["file","reset","submit","button"].indexOf(t.type)||("select-multiple"===t.type?Array.prototype.slice.call(t.options).forEach(function(e){e.selected&&n.push(encodeURIComponent(t.name)+"="+encodeURIComponent(e.value))}):-1<["checkbox","radio"].indexOf(t.type)&&!t.checked||n.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value)))}),n.join("&")}};