/*! the-hive */
var NOW=new Date,promptNext=new Date((new Date).setDate((new Date).getDate()+1)),noPrompt=new Date((new Date).setFullYear((new Date).getFullYear()+1));$(function(){var n,e;Modernizr.localstorage&&(n="#followCTAModal, #signupCTAModal",(e=$(n)).on("click",".close, .js-close-cta-modal",function(){NOW=new Date,promptNext=new Date((new Date).setDate((new Date).getDate()+1));var e=$(this).closest(n);e.is("#followCTAModal")?localStorage.setItem(CCM_CID+"_PROMPT",promptNext):e.is("#signupCTAModal")&&localStorage.setItem(CCM_SITEID+"_PROMPT",promptNext)}),e.on("change",".dontAsk",function(){NOW=new Date,noPrompt=new Date((new Date).setFullYear((new Date).getFullYear()+1));var e=$(this),o=e.prop("checked"),e=e.closest(n);o&&e.is("#followCTAModal")&&localStorage.setItem(CCM_CID+"_PROMPT",noPrompt),o&&e.is("#signupCTAModal")&&localStorage.setItem(CCM_SITEID+"_PROMPT",noPrompt),e.modal("hide")}),e.on("click",".btn-inline-block",function(){var e=$(this).closest(n);NOW=new Date,noPrompt=new Date((new Date).setFullYear((new Date).getFullYear()+1)),e.is("#followCTAModal")?(localStorage.setItem(CCM_CID+"_PROMPT",noPrompt),void 0!==app.hive.projectFollow&&e.on("hidden.bs.modal",function(){app.hive.projectFollow.follow()}),e.modal("hide")):e.is("#signupCTAModal")&&(localStorage.setItem(CCM_SITEID+"_PROMPT",noPrompt),e.modal("hide"),e.on("hidden.bs.modal",function(){$("#signUpModal").modal("show")}))}),app.config.prompts.signUp)&&Modernizr.localstorage&&$(window).on("feedback.hive",function(){var e;CCM_LOGGED_IN||(NOW=new Date,e=localStorage.getItem(CCM_SITEID+"_PROMPT")||NOW,NOW.getTime()>=Date.parse(e)&&$("#signupCTAModal").modal("show"))})}),function(e,i){"use strict";function l(e,o){var n="";if(void 0!==o)if("delimToLists"==e&&"string"==typeof o&&0<o.length)n="<ul><li>"+(n=o.replace(/,\s*$/,"")).replace(/\|/g,"</li><li>")+"</li></ul>";else if("objArrayToLists"==e&&"[object Array]"===Object.prototype.toString.call(o))n+="<ul>",i.each(o,function(e,o){n+="<li>"+o.text+"</li>"}),n+="</ul>";else if("arrayToLists"==e&&Array.isArray(o)){n+="<ul>";for(var t=o.length-1;0<=t;t--)n+="<li>"+o[t]+"</li>";n+="</ul>"}else if("stringToNewLine"==e&&"string"==typeof o)n=0<o.length&&-1<o.indexOf("|")?o.replace(/,\s*$/,"").replace(/\|/g,"<br>"):o;else if("stringToBadge"==e&&"string"==typeof o&&0<o.length)if(0<o.length){var l=o.replace(/,\s*$/,"").split(/\|/g);if(2<l.length){for(var s=0;s<2;s++)n+='<span class="badge badge-default">'+l[s]+"</span>";e=o.replace(/,\s*$/,"").replace(/\|/g,", "),n+='<span class="badge badge-default"><a data-html="true" class="launch-tooltip" data-original-title="'+e+'">. . .</a></span>'}else n='<span class="badge badge-default">'+(n=o.replace(/,\s*$/,"")).replace(/\|/g,'</span><span class="badge badge-default">')+"</span>"}else n=o;else n=o;return n}e.document;e.hiveDataTables={usernameRenderer:function(e,o,n,t){return""!==e?'<a href="#" data-user-id="'+n[0]+'">'+e+"</a>":"NA"},locationsRenderer:function(e,o,n,t){return l.call(this,"delimToLists",e)},projectsRenderer:function(e,o,n,t){return l.call(this,"objArrayToLists",e)},interestsRenderer:function(e,o,n,t){return l.call(this,"delimToLists",e)},stringToBadgeRenderer:function(e,o,n,t){return l.call(this,"stringToBadge",e)},stringToNewLineRenderer:function(e,o,n,t){return l.call(this,"stringToNewLine",e)},subscriptionRenderer:function(e,o,n,t){return 0<parseInt(e)?'<span class="badge bg-primary">Subscribed</span>':""},newsletterRenderer:function(e,o,n,t){return 0<e?"Yes":" No"}}}(this,jQuery),function(e,s){"use strict";var i,a,o,n,t,l,r,c;i={apiURL:"",sid:"",pid:0,uid:"",email:"",token:"",setSessUrl:"",unSetSessUrl:"",unCheckSessUrl:"",getTokenUrl:"",requestType:"POST",onFollow:function(e){},onUnFollow:function(e){},messages:{follow:{title:"",description:""},unfollow:{title:"",description:""},prompt:{title:"",description:""}},labels:{follow:"",following:"",unfollow:""},initFollow:!1,promptToFollow:!1},o=null,t=n=!(a={}),l=function(e){"subscribed"==e?(t=!0,null!==o&&(o.find(".fa").removeClass("fa-plus").addClass("fa-check"),o.addClass("mod-following"),o.find("span").text(i.labels.following),o.attr("aria-label","Following - click to unfollow"),o.on("mouseenter focusin",r),o.on("mouseleave focusout",c))):"unsubscribed"==e&&(t=!1,null!==o)&&(o.find(".fa").removeClass("fa-check fa-times").addClass("fa-plus"),o.removeClass("mod-following"),o.find("span").text(i.labels.follow),o.attr("aria-label","Follow"),o.off("mouseenter focusin",r),o.off("mouseleave focusout",c))},r=function(){o.find(".fa").removeClass("fa-check").addClass("fa-times"),o.find("span").text(i.labels.unfollow)},c=function(){o.find(".fa").removeClass("fa-times").addClass("fa-check"),o.find("span").text(i.labels.following)},u.prototype={bind:function(e){!function(e){void 0!==e&&((o=e).removeClass("is-loading"),o.on("click",function(){d(s(this))}))}.call(this,e)},isFollowing:function(){return t},follow:function(e,o){return void 0!==o&&(i.pid=parseInt(o)),g.call(this,e)},unfollow:function(e,o){return void 0!==o&&(i.pid=parseInt(o)),m.call(this,e)}},e.ProjectFollow=u;function u(e){if((i=s.extend({},i,e)).pid=parseInt(i.pid),""===i.apiURL||""===i.sid||""===i.uid||""===i.token||""===i.setSessUrl||""===i.unCheckSessUrl||""===i.unSetSessUrl||""===i.getTokenUrl)throw new Error("Missing configuration");var o;a=s.extend({},a,{pid:i.pid}),0<i.uid?n=!0:((e=s("#signUpModal, #loginModal, #resetPasswordModal")).on("click",'button[data-dismiss="modal"]',function(){f("unset_sess")}),e.on("keydown",function(e){27==e.keyCode&&f("unset_sess")})),p(function(){!t&&i.initFollow&&(g(),f("unset_sess"))}),s(window).on("signedin.hive",function(e){""!==e.uID&&""!==e.attributes.email&&(i.uid=e.uID,i.email=e.attributes.email,n=!0,f("get_token",null,function(e){e.token&&(i.token=e.token),p(function(){f("check_sess",null,function(e){!t&&e.project&&(g(),f("unset_sess"))},null)})}))}),Modernizr.localstorage&&(o=this,s(window).on("feedback.hive",function(){var e;i.promptToFollow&&(NOW=new Date,e=localStorage.getItem(CCM_CID+"_PROMPT")||NOW,!1===o.isFollowing())&&NOW.getTime()>=Date.parse(e)&&s("#followCTAModal").modal("show")}))}function d(){var e;n?(t?m:g)():(a={pid:i.pid},f("set_sess"),e=s("<div/>",{id:"pfPrompt",class:"alert alert-info ljs",role:"alert"}).html(i.messages.prompt.description),s("#signUpModal").find(".modal-title").before(e),s("#signUpModal").modal("show"),s("#signUpModal").one("hidden.bs.modal",function(){s(this).find("#pfPrompt").remove()}))}function f(e,o,t,n){var l="";if("set_sess"===e)l=i.setSessUrl,i.requestType="POST";else if("unset_sess"===e)l=i.unSetSessUrl,i.requestType="POST";else if("check_sess"===e)l=i.unCheckSessUrl,i.requestType="GET";else if("get_token"===e)l=i.getTokenUrl,i.requestType="GET";else{if(0===i.pid)throw new Error("Missing configuration, Project ID required");if(0==i.uid&&"activate"!==e)return!1;i.requestType="activate"===e||"deactivate"===e?"POST":"GET",l=i.apiURL+e+"/"+i.pid}s.ajax({url:l,data:a,headers:{authtoken:i.token},method:i.requestType,dataType:"json",beforeSend:function(){null!=o&&o()},success:function(e,o,n){null!=t&&t(e,o,n)},complete:function(e,o){null!=n&&n(e,o)}})}function p(o){n&&0!==i.pid&&f("is-active",null,function(e){"success"==e.connection?l(e.message):console.error("API connection failed."),null!==o&&"function"==typeof o&&o()},null)}function g(t){if(n)return f("activate",function(){null!==o&&o.addClass("is-loading")},function(e){var o,n;"success"==e.connection&&(l("subscribed"),o=function(){HiveAlerts.success({title:i.messages.follow.title,message:i.messages.follow.description,classes:"ljs"})},(n=s(".modal.in").attr("id")||!1)?s("#"+n).one("hidden.bs.modal",function(){o()}):o(),_paq.push(["trackEvent","the_hive_project_follow","follow",i.pid]),void 0===t&&void 0!==i.onFollow?i.onFollow(e):void 0!==t&&t(e))},function(){null!==o&&o.removeClass("is-loading")});d()}function m(t){return f("deactivate",function(){null!==o&&o.addClass("is-loading")},function(e){var o,n;"success"==e.connection?(l("unsubscribed"),o=function(){HiveAlerts.error({title:i.messages.unfollow.title,message:i.messages.unfollow.description,classes:"ljs"})},(n=s(".modal.in").attr("id")||!1)?s("#"+n).one("hidden.bs.modal",function(){o()}):o(),_paq.push(["trackEvent","the_hive_project_follow","unfollow",i.pid]),void 0===t&&void 0!==i.onUnFollow?i.onUnFollow(e):void 0!==t&&t(e)):console.error("API connection failed.")},function(){null!==o&&o.removeClass("is-loading")})}}(this,$);